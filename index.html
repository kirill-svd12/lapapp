<!DOCTYPE html>
<!--
  Для работы Google таблицы:
  1. Откройте нужную таблицу в Google Sheets → Файл → Опубликовать в интернете → Встроить → Скопируйте ссылку вида:
     https://docs.google.com/spreadsheets/d/e/ВАШ_ID/pubhtml?widget=true&headers=false
  2. Вставьте этот адрес в переменную googleSheetsUrl в <script> в <head>.

  Для изменения версии и даты обновления:
  - Измените значения переменных botVersion и lastUpdateDate в <script> в <head>.
-->
<html lang="ru" style="height: 100%;">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QuestApp</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script async
        src="https://telegram.org/js/telegram-widget.js?15"
        data-telegram-login="lapabot_bot"
        data-size="large"
        data-userpic="false"
        data-request-access="write"
        data-onauth="onTelegramAuth(user)"
    ></script>
    <script>
      // === Настройки приложения ===
      const botVersion = '1.1.6';
      const lastUpdateDate = '01.07.2025';
      const googleSheetsUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vT9fzIQ878rfJa1xlMFpVfWUankyDTXY57A3xD4wPr2bIoKVjLS-9jlSHs_zDwAHXPsoP_sZpGm1tM7/pub?gid=0&single=true&output=csv';
      const adminIds = [5014279740]; // Ваш Telegram ID
      const googleScriptUrl = 'https://wild-limit-5cdb.kirillsvedesev.workers.dev/';
      const botUsername = 'lapabot_bot'; // Имя вашего бота

      // === Supabase настройки для кликера ===
      const supabaseUrl = 'https://sqpfscuyofevrywfbubm.supabase.co';
      const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNxcGZzY3V5b2ZldnJ5d2ZidWJtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE0NTA0NTIsImV4cCI6MjA2NzAyNjQ1Mn0.QQFwpBpMSe1eslWPpMGV86qCsYluHUvMYEBEn-lqFdo'; // вставьте свой ключ

      // Получить максимум кликов пользователя
      async function getUserClicks(username) {
        const res = await fetch(`${supabaseUrl}/rest/v1/clicks?username=eq.${encodeURIComponent(username)}`, {
          headers: {
            'apikey': supabaseKey,
            'Authorization': `Bearer ${supabaseKey}`,
            'Content-Type': 'application/json'
          }
        });
        const data = await res.json();
        return data.length > 0 ? data[0].clicks : 0;
      }

      // Сохранить максимум кликов пользователя (upsert)
      async function saveUserClicks(username, clicks) {
        // upsert (insert/update)
        const res = await fetch(`${supabaseUrl}/rest/v1/clicks`, {
          method: 'POST',
          headers: {
            'apikey': supabaseKey,
            'Authorization': `Bearer ${supabaseKey}`,
            'Content-Type': 'application/json',
            'Prefer': 'resolution=merge-duplicates'
          },
          body: JSON.stringify([{ username, clicks }])
        });
        if (!res.ok) throw new Error('Ошибка сохранения');
        return await res.json();
      }

      // === Ссылки на проекты ===
      const projectLinks = {
          actionGames: {
              stress18: 'https://telegra.ph/Proekt-Stress-06-16', // Проект стресс 18+
              lastOfUs18: 'https://telegra.ph/The-Last-of-Us-06-16-2', // The last of us 18+
              alkatras18: 'https://telegra.ph/Pryatki-v-Alkatrase-06-16', // Прятки в Алькатрасе 18+
          },
          immersive: {
              suspicion14: 'https://telegra.ph/Podozrenie-padaet-na-05-23', // Подозрение падает на 14+
              familyVow16: 'https://telegra.ph/Semejnyj-obet-05-23', // Семейный обет 16+
              insaneParanoid16: 'https://telegra.ph/Insane-Paranoid-06-16', // Insane Paranoid 16+
              whoHid12: 'https://telegra.ph/Kto-ne-spryatalsya-06-16', // Кто не спрятался 12+
          },
          escape: {
              moreDifficult: {
                  foris16: 'https://telegra.ph/Obekt-Foris-06-16',  // Объект форис 16+
                  arthur14: 'https://telegra.ph/Mech-korolya-Artura-06-16-2', // Меч короля Артура 14+(10+)
                  tenLittleIndians14: 'https://telegra.ph/Desyat-negrityat-06-16', // 10 негритят 14+
                  airCaptivity14: 'https://telegra.ph/Vozdushnyj-plen-06-16', // Воздушный плен 14+(10+)
                  inheritance14: 'https://telegra.ph/Vkus-nasledstva-06-16', // Вкус наследства 14+(11+)
              },
              lessDifficult: {
                  backToUSSR14: 'https://telegra.ph/Nazad-v-SSSR-perezagruzka-06-16', // Назад в СССР: перегрузка 14+(12+)
                  byTouch14: 'https://telegra.ph/Na-oshchup-06-16', // На ощупь 14+(12+)
                  pharaoh7riddles14: 'https://telegra.ph/7-zagadok-faraona-06-16', // 7 загадок фараона 14+(10+)
                  oblivionAvalanche14: 'https://telegra.ph/Lavina-zabveniya-06-16', // Лавина забвения 14+(8+)
              }
          },
          maniac: {
              wrongTurn16: 'https://telegra.ph/Povorot-ne-tuda-06-16', // Поворот не туда 16+
              uninvitedGuests12: 'https://telegra.ph/Nezvanye-gosti-06-16', // Незваные гости 12+
              fatum18: 'https://telegra.ph/Proekt-Fatum-06-16', // Проект Fatum 18+
          },
          mystic: {
              nightmares14: 'https://telegra.ph/Nightmares-06-16', // Nightmares 14+
              evilWithin16: 'https://telegra.ph/The-Evil-Within-06-16', // The Evil Within 16+
              outlast16: 'https://telegra.ph/Outlast-06-16', // Outlast 16+
              amnesia16: 'https://telegra.ph/Amnesia-06-16', // Amnesia 16+
              fear16: 'https://telegra.ph/Fear-06-16', // Fear 16+
              poltergeist16: 'https://telegra.ph/Poltergejst-06-16', // Полтергейст 16+
              fnaf18: 'https://telegra.ph/Five-Nights-at-Freddys-06-16-2', // Five Nights at Freddy's 18+(12+)
              saw16: 'https://telegra.ph/Pila-06-16', // Пила 16+
              it16: 'https://telegra.ph/Ono-06-16', // Оно 16+
              babadook15: 'https://telegra.ph/Babadook-06-16', // Babadook 15+(12+)
              gloom16: 'https://telegra.ph/Mgla-06-16', // Мгла 16+(12+)
              tarotDeathCard18: 'https://telegra.ph/Taro-karta-smerti-06-16', // Таро: карта смерти 18+(16+)
              gravediggers14: 'https://telegra.ph/Iskateli-mogil-06-16', // Искатели могил 14+
          },
          mixed: {
              aven14: 'https://telegra.ph/Lechebnica-sv-Avena-06-16', // Авен 14+
              rage16: 'https://telegra.ph/Rage-06-16', // Rage 16+
              momo14: 'https://telegra.ph/Momo-06-16', // Момо 14+
              deadInside12: 'https://telegra.ph/Dead-Inside-06-16', // Dead inside 12+
              ahs12: 'https://telegra.ph/Amerikanskaya-istoriya-uzhasov-06-16', // Американская история ужасов 12+
              sidr12: 'https://telegra.ph/Strashnye-istorii-dlya-rasskazov-v-temnote-06-15', // СИДР 12+
              scp14: 'https://telegra.ph/SCP-06-15', // Scp 14+
              forMoney14: 'https://telegra.ph/Za-dengi---da-06-15', // За деньги - да 14+(12+)
          }
      };
    </script>
    <style>
        :root {
            --primary-color: #FFB6C1;
            --secondary-color: #FFF0F5;
            --text-color: #4A4A4A;
            --bg-color: #FFFFFF;
            --button-text-color: #4A4A4A;
            --card-shadow: 0 8px 32px rgba(255, 182, 193, 0.15);
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --gradient-start: #FFB6C1;
            --gradient-end: #FFC0CB;
            --glass-bg: rgba(255, 255, 255, 0.9);
            --glass-border: rgba(255, 182, 193, 0.2);
            --accent-color: #FF69B4;
        }

        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #FFFFFF 0%, #FFF0F5 100%);
            color: var(--text-color);
            line-height: 1.6;
            min-height: 100vh;
            height: 100%;
            position: relative;
            overflow-x: hidden;
            background-attachment: fixed; /* Применено ко всем размерам экрана */
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 20%, rgba(255, 182, 193, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(255, 192, 203, 0.1) 0%, transparent 50%);
            pointer-events: none;
            z-index: -1;
        }

        #app {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
        }

        .screen {
            display: none;
            margin-bottom: 30px;
            animation: fadeIn 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
        }

        @keyframes fadeIn {
            from { 
                opacity: 0; 
                transform: translateY(20px) scale(0.98);
            }
            to { 
                opacity: 1; 
                transform: translateY(0) scale(1);
            }
        }

        .screen.active {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
        }

        .text-content {
            background: var(--glass-bg);
            padding: 40px;
            border-radius: 30px;
            margin-bottom: 0;
            box-shadow: var(--card-shadow);
            font-size: 16px;
            line-height: 1.8;
            white-space: pre-wrap;
            backdrop-filter: blur(12px);
            border: 1px solid var(--glass-border);
            position: relative;
            overflow: hidden;
            transform: translateZ(0);
            grid-column: 1 / -1;
        }

        .text-content::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 6px;
            background: linear-gradient(90deg, var(--gradient-start), var(--gradient-end));
            opacity: 0.8;
        }

        .button-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .button {
            display: flex;
            align-items: center;
            width: 100%;
            padding: 20px 30px;
            margin: 0;
            background: var(--glass-bg);
            color: var(--button-text-color);
            border: 2px solid var(--glass-border);
            border-radius: 20px;
            cursor: pointer;
            text-align: left;
            font-size: 16px;
            font-weight: 500;
            transition: var(--transition);
            box-shadow: var(--card-shadow);
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(5px);
        }

        .button::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                45deg,
                transparent,
                rgba(255, 182, 193, 0.1),
                transparent
            );
            transform: translateX(-100%);
            transition: 0.6s;
        }

        .button:hover {
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 12px 30px rgba(255, 182, 193, 0.25);
            border-color: var(--accent-color);
            color: var(--accent-color);
        }

        .button:active {
            transform: translateY(-1px) scale(0.98);
        }

        .back-button {
            background: var(--glass-bg);
            color: var(--accent-color);
            font-weight: 500;
            border: 2px solid var(--accent-color);
            box-shadow: none;
            backdrop-filter: blur(8px);
            grid-column: 1 / -1;
            justify-content: center;
        }

        .back-button:hover {
            background: rgba(255, 182, 193, 0.1);
            transform: translateY(-2px);
        }

        /* Стили для квизов */
        .quiz-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
        }

        .quiz-question {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 30px;
            color: var(--accent-color);
            text-align: center;
            text-shadow: 0 2px 4px rgba(255, 182, 193, 0.1);
        }

        .quiz-options {
            margin: 25px 0;
            padding: 30px;
            background: var(--glass-bg);
            border-radius: 25px;
            border: 1px solid var(--glass-border);
            box-shadow: var(--card-shadow);
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        /* Стили для историй */
        .stories-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
        }

        .story {
            margin: 0;
            padding: 30px;
            background: var(--glass-bg);
            border-radius: 25px;
            border: 1px solid var(--glass-border);
            box-shadow: var(--card-shadow);
            transition: var(--transition);
            backdrop-filter: blur(8px);
        }

        .story:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 15px 35px rgba(255, 182, 193, 0.2);
            border-color: var(--accent-color);
        }

        .story-title {
            font-weight: 600;
            margin-bottom: 20px;
            color: var(--accent-color);
            font-size: 20px;
            text-shadow: 0 2px 4px rgba(255, 182, 193, 0.1);
        }

        /* Стили для видео-секции */
        .video-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-top: 35px;
        }

        /* Адаптивный дизайн */
        @media (max-width: 768px) {
            #app {
                padding: 15px;
            }

            .button-container {
                grid-template-columns: 1fr;
            }

            .text-content {
                padding: 25px;
            }

            .quiz-options {
                grid-template-columns: 1fr;
            }
        }

        /* Анимации для переходов */
        .screen.active {
            animation: slideIn 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(40px) scale(0.98);
            }
            to {
                opacity: 1;
                transform: translateX(0) scale(1);
            }
        }

        /* Стили для заголовков */
        h1, h2, h3 {
            color: var(--accent-color);
            margin-bottom: 25px;
            text-align: center;
            font-weight: 600;
            text-shadow: 0 2px 4px rgba(255, 182, 193, 0.1);
        }

        h1 {
            font-size: 36px;
            margin-bottom: 35px;
            background: linear-gradient(135deg, var(--gradient-start), var(--gradient-end));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        h2 {
            font-size: 28px;
        }

        h3 {
            font-size: 24px;
        }

        /* Стили для эмодзи */
        .emoji {
            font-size: 1.4em;
            margin-right: 12px;
            filter: drop-shadow(0 2px 4px rgba(255, 182, 193, 0.2));
        }

        /* Стили для ссылок */
        a {
            color: var(--accent-color);
            text-decoration: none;
            transition: var(--transition);
            position: relative;
            font-weight: 500;
        }

        a::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 0;
            height: 2px;
            background: linear-gradient(90deg, var(--gradient-start), var(--gradient-end));
            transition: var(--transition);
            opacity: 0.8;
        }

        a:hover::after {
            width: 100%;
        }

        /* Дополнительные стили */
        .features {
            background: var(--glass-bg);
            padding: 35px;
            border-radius: 25px;
            margin: 30px 0;
            border: 1px solid var(--glass-border);
            box-shadow: var(--card-shadow);
            backdrop-filter: blur(8px);
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .note {
            background: var(--glass-bg);
            padding: 25px 30px;
            border-radius: 20px;
            margin-top: 25px;
            font-style: italic;
            border-left: 5px solid var(--accent-color);
            box-shadow: var(--card-shadow);
            backdrop-filter: blur(8px);
        }

        /* Стили для списков */
        .features p {
            margin: 0;
            padding: 20px;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 15px;
            transition: var(--transition);
            border: 1px solid var(--glass-border);
        }

        .features p:hover {
            transform: translateX(10px) scale(1.02);
            background: rgba(255, 255, 255, 0.8);
            box-shadow: 0 5px 15px rgba(255, 182, 193, 0.1);
            border-color: var(--accent-color);
        }

        /* Дополнительные эффекты */
        .text-content, .button, .story, .features, .note {
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1),
                        box-shadow 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* Эффект параллакса для фона */
        @media (min-width: 768px) {
            body {
                background-attachment: fixed;
            }
        }

        /* Добавляем стили для логотипа */
        .logo {
            position: fixed;
            top: 20px;
            left: 20px;
            font-size: 24px;
            font-weight: 700;
            color: var(--accent-color);
            text-decoration: none;
            z-index: 1000;
            padding: 10px 20px;
            background: var(--glass-bg);
            border-radius: 15px;
            border: 1px solid var(--glass-border);
            backdrop-filter: blur(8px);
            transition: var(--transition);
            display: none; /* Скрыто по умолчанию */
        }

        .logo.visible { /* Новый класс для видимости */
            display: block;
        }

        .logo:hover {
            transform: translateY(-2px);
            box-shadow: var(--card-shadow);
        }

        .logo-age {
            display: block;
            font-size: 14px;
            font-weight: 500;
            opacity: 0.7;
            margin-top: 2px;
            color: var(--text-color);
        }

        /* Стили для футера */
        .footer {
            /* position: fixed; */ /* УДАЛЕНО */
            /* bottom: -100px; */ /* УДАЛЕНО */
            left: 0;
            right: 0;
            background: var(--glass-bg);
            padding: 15px;
            text-align: center;
            font-size: 14px;
            color: var(--text-color);
            border-top: 1px solid var(--glass-border);
            backdrop-filter: blur(8px);
            z-index: 1000;
            /* transition: transform 0.3s ease-in-out; */ /* УДАЛЕНО */
            opacity: 0; /* Скрыто по умолчанию */
            transition: opacity 0.3s ease-in-out; /* Анимация появления/исчезновения */
            pointer-events: none; /* Не реагирует на события, когда скрыт */
        }

        .footer.visible {
            opacity: 1; /* Показываем футер */
            pointer-events: auto; /* Реагирует на события, когда виден */
            /* transform: translateY(-100px); */ /* УДАЛЕНО */
        }

        .footer p {
            margin: 5px 0;
        }

        /* Обновляем стили для основного контента */
        #app {
            padding-top: 80px;
            padding-bottom: 100px; /* Оставим, чтобы дать место для футера, если он будет внизу */
        }

        /* Обновляем стили для начального экрана */
        .welcome-screen {
            display: grid;
            grid-template-columns: 1fr;
            gap: 30px;
            text-align: center;
        }

        .welcome-title {
            font-size: 42px;
            margin-bottom: 20px;
            background: linear-gradient(135deg, var(--gradient-start), var(--gradient-end));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .welcome-subtitle {
            font-size: 18px;
            color: var(--text-color);
            margin-bottom: 40px;
            opacity: 0.8;
        }

        .main-menu {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .main-menu .button {
            height: 100px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 20px;
        }

        .main-menu .emoji {
            font-size: 2em;
            margin-bottom: 10px;
        }

        /* Дополнительные стили для отображения данных из таблицы */
        .lapabalts-container {
            display: grid;
            grid-template-columns: 1fr 1fr; /* Две колонки для имени и баллов */
            gap: 10px;
            background: var(--glass-bg);
            padding: 20px;
            border-radius: 20px;
            box-shadow: var(--card-shadow);
            backdrop-filter: blur(8px);
            margin-top: 20px;
            width: 100%;
            grid-column: 1 / -1;
            /* Удаляем max-height и overflow-y */
        }

        .lapabalts-header {
            font-weight: 600;
            color: var(--accent-color);
            padding: 10px;
            border-bottom: 1px solid var(--glass-border);
            text-align: center;
        }

        .lapabalts-item {
            padding: 10px;
            border-bottom: 1px dashed var(--glass-border);
            text-align: center;
        }

        .lapabalts-item:nth-child(4n-1), .lapabalts-item:nth-child(4n) { /* Чередуем фон для строк данных */
            background-color: rgba(255, 182, 193, 0.05);
        }

        .lapabalts-item:last-child {
            border-bottom: none;
        }

        /* Стили для Telegram Login */
        #telegram-login-container {
            text-align: center;
            margin: 0;
            padding: 0;
            background: transparent;
            border-radius: 0;
            border: none;
            box-shadow: none;
        }

        /* Белый фон для экранов */
        .white-bg {
            background: #ffffff !important;
        }

        .white-bg::before {
            display: none !important;
        }

        /* Стили для модального окна */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(8px);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            animation: fadeIn 0.3s ease-out;
        }

        .modal-content {
            background: var(--glass-bg);
            padding: 40px;
            border-radius: 25px;
            border: 1px solid var(--glass-border);
            box-shadow: 0 20px 60px rgba(255, 182, 193, 0.3);
            backdrop-filter: blur(12px);
            text-align: center;
            max-width: 400px;
            margin: 20px;
            animation: slideIn 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .modal-content::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, var(--gradient-start), var(--gradient-end));
            opacity: 0.8;
        }

        .modal-icon {
            font-size: 4em;
            margin-bottom: 20px;
            animation: bounce 2s infinite;
        }

        .modal-title {
            font-size: 28px;
            font-weight: 600;
            color: var(--accent-color);
            margin-bottom: 15px;
            text-shadow: 0 2px 4px rgba(255, 182, 193, 0.1);
        }

        .modal-text {
            font-size: 16px;
            color: var(--text-color);
            line-height: 1.6;
            margin-bottom: 30px;
            opacity: 0.8;
        }

        .modal-button {
            background: linear-gradient(135deg, var(--gradient-start), var(--gradient-end));
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 15px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: 0 8px 25px rgba(255, 182, 193, 0.3);
        }

        .modal-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(255, 182, 193, 0.4);
        }

        .modal-button:active {
            transform: translateY(-1px);
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {
                transform: translateY(0);
            }
            40% {
                transform: translateY(-10px);
            }
            60% {
                transform: translateY(-5px);
            }
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-50px) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        /* Стили для новостей */
        .news-item {
            background: var(--glass-bg);
            padding: 25px;
            border-radius: 20px;
            margin: 20px 0;
            border: 1px solid var(--glass-border);
            box-shadow: var(--card-shadow);
            backdrop-filter: blur(8px);
        }
        .news-author {
            font-weight: 600;
            color: var(--accent-color);
            margin-bottom: 10px;
        }
        .news-date {
            font-size: 12px;
            color: #888;
            margin-bottom: 15px;
        }
        .news-text {
            line-height: 1.6;
        }

        /* --- Новый дизайн для главного меню --- */
        .lapaclicker-main-btn {
            background: linear-gradient(90deg, #ffb6c1 0%, #ff69b4 100%);
            color: #fff;
            font-size: 1.4em;
            font-weight: 700;
            box-shadow: 0 8px 32px rgba(255, 182, 193, 0.25);
            border: none;
            letter-spacing: 1px;
            margin-bottom: 18px;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .lapaclicker-main-btn:hover {
            transform: scale(1.04) translateY(-2px);
            box-shadow: 0 16px 40px rgba(255, 182, 193, 0.35);
            color: #fff;
        }

        /* --- Новый дизайн для ЛапаКликера --- */
        .lapaclicker-bg {
            min-height: 80vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #fff0f5 0%, #ffe4ec 100%);
            border-radius: 30px;
            box-shadow: 0 8px 32px rgba(255, 182, 193, 0.15);
            padding: 30px 0;
        }
        .lapaclicker-card {
            background: rgba(255,255,255,0.98);
            border-radius: 32px;
            box-shadow: 0 8px 32px rgba(255, 182, 193, 0.18);
            padding: 40px 30px 30px 30px;
            max-width: 400px;
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            animation: fadeIn 0.7s cubic-bezier(0.4,0,0.2,1);
        }
        .lapaclicker-title {
            font-size: 2.2em;
            font-weight: 800;
            background: linear-gradient(90deg, #ffb6c1 0%, #ff69b4 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 24px;
            letter-spacing: 1px;
            text-align: center;
        }
        .lapaclicker-auth label {
            font-size: 1.1em;
            color: #ff69b4;
            font-weight: 600;
        }
        .lapaclicker-auth input {
            margin-top: 12px;
            padding: 14px 18px;
            border-radius: 12px;
            border: 1.5px solid #ffd1e3;
            font-size: 1.1em;
            width: 90%;
            max-width: 260px;
            margin-bottom: 12px;
            background: #fff8fa;
            transition: border 0.2s;
        }
        .lapaclicker-auth input:focus {
            border: 1.5px solid #ff69b4;
            outline: none;
        }
        .lapaclicker-btn {
            background: linear-gradient(90deg, #ffb6c1 0%, #ff69b4 100%);
            color: #fff;
            font-size: 1.2em;
            font-weight: 700;
            border: none;
            border-radius: 16px;
            padding: 18px 0;
            width: 100%;
            margin: 10px 0 0 0;
            box-shadow: 0 4px 16px rgba(255, 182, 193, 0.18);
            cursor: pointer;
            transition: background 0.2s, transform 0.2s, box-shadow 0.2s;
            letter-spacing: 1px;
        }
        .lapaclicker-btn:hover {
            background: linear-gradient(90deg, #ff69b4 0%, #ffb6c1 100%);
            transform: scale(1.03);
            box-shadow: 0 8px 32px rgba(255, 182, 193, 0.25);
        }
        .lapaclicker-btn.save-btn {
            margin-bottom: 18px;
            font-size: 1.1em;
            background: linear-gradient(90deg, #ff69b4 0%, #ffb6c1 100%);
        }
        .lapaclicker-btn.click-btn {
            font-size: 2em;
            padding: 32px 0;
            margin-top: 10px;
            background: linear-gradient(90deg, #ffb6c1 0%, #ff69b4 100%);
            color: #fff;
            border: none;
            border-radius: 24px;
            box-shadow: 0 8px 32px rgba(255, 182, 193, 0.18);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: background 0.2s, box-shadow 0.2s;
        }
        .lapaclicker-btn.click-btn:hover {
            background: linear-gradient(90deg, #ff69b4 0%, #ffb6c1 100%);
            box-shadow: 0 16px 40px rgba(255, 182, 193, 0.25);
        }
        .lapaclicker-btn.click-btn:active {
            /* Без transform: scale, чтобы не было увеличения! */
            background: linear-gradient(90deg, #ffb6c1 0%, #ff69b4 100%);
            box-shadow: 0 4px 16px rgba(255, 182, 193, 0.18);
        }
        .paw-emoji {
            font-size: 2.5em;
            margin-bottom: 8px;
            animation: bounce 1.2s infinite;
        }
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        .lapaclicker-stats {
            display: flex;
            justify-content: space-between;
            width: 100%;
            margin-bottom: 12px;
            gap: 8px;
        }
        .lapaclicker-stat {
            background: #fff0f5;
            border-radius: 12px;
            padding: 10px 14px;
            font-size: 1.1em;
            font-weight: 600;
            color: #ff69b4;
            box-shadow: 0 2px 8px rgba(255, 182, 193, 0.08);
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .lapaclicker-game {
            width: 100%;
            max-width: 340px;
            margin: 0 auto;
        }
        @media (max-width: 600px) {
            .lapaclicker-card {
                padding: 18px 6px 18px 6px;
                max-width: 98vw;
            }
            .lapaclicker-game {
                max-width: 98vw;
            }
        }
        .lapaclicker-game {
            background: linear-gradient(135deg, #fff0f6 0%, #fceabb 100%);
            border-radius: 32px;
            box-shadow: 0 8px 32px rgba(255,182,193,0.18);
            padding: 32px 16px;
            margin: 0 auto;
            max-width: 400px;
        }
        .lapaclicker-stats {
            display: flex;
            justify-content: space-between;
            margin-bottom: 18px;
            font-size: 1.2em;
            font-weight: 600;
            color: #d72660;
        }
        .lapaclicker-stat {
            background: #fff;
            border-radius: 12px;
            padding: 10px 18px;
            margin: 0 4px;
            box-shadow: 0 2px 8px rgba(255,182,193,0.08);
            transition: box-shadow 0.2s;
        }
        .lapaclicker-btn.save-btn {
            background: linear-gradient(90deg, #ffb6c1 0%, #ff69b4 100%);
            color: #fff;
            font-size: 1.1em;
            border-radius: 16px;
            margin-bottom: 18px;
            box-shadow: 0 4px 16px rgba(255,182,193,0.15);
        }
        .lapaclicker-btn.click-btn {
            font-size: 2em;
            padding: 32px 0;
            background: linear-gradient(90deg, #ffb6c1 0%, #ff69b4 100%);
            color: #fff;
            border-radius: 24px;
            box-shadow: 0 8px 32px rgba(255,182,193,0.18);
            transition: background 0.2s, box-shadow 0.2s;
        }

        .modal-soon {
          position: fixed;
          top: 0; left: 0; right: 0; bottom: 0;
          background: rgba(0,0,0,0.25);
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 9999;
        }
        .modal-soon-content {
          background: #fff;
          border-radius: 18px;
          padding: 32px 24px;
          box-shadow: 0 8px 32px rgba(0,0,0,0.12);
          font-size: 1.2em;
          text-align: center;
        }
        .modal-soon-content button {
          margin-top: 18px;
          background: #ff69b4;
          color: #fff;
          border: none;
          border-radius: 10px;
          padding: 10px 28px;
          font-size: 1em;
          cursor: pointer;
          transition: background 0.2s;
        }
        .modal-soon-content button:hover {
          background: #d72660;
        }
        /* Добавляю стили для анимированного спиннера */
        .lapaclicker-spinner {
          display: inline-block;
          width: 24px;
          height: 24px;
          border: 3px solid #ffb6c1;
          border-top: 3px solid #ff69b4;
          border-radius: 50%;
          animation: lapaclicker-spin 1s linear infinite;
          vertical-align: middle;
          margin-left: 6px;
        }
        @keyframes lapaclicker-spin {
          0% { transform: rotate(0deg); }
          100% { transform: rotate(360deg); }
        }
        /* Добавляю новые стили для минималистичного кликера */
        .lapaclicker-new {
          background: #fff;
          border-radius: 18px;
          padding: 24px 10px 18px 10px;
          max-width: 340px;
          margin: 0 auto;
          display: flex;
          flex-direction: column;
          align-items: center;
          box-shadow: none;
          border: 1.5px solid #ffe4ec;
        }
        .lapaclicker-new-title {
          font-size: 1.5em;
          font-weight: 700;
          color: #d72660;
          margin-bottom: 18px;
          letter-spacing: 1px;
        }
        .lapaclicker-new-stats {
          display: flex;
          justify-content: space-between;
          width: 100%;
          margin-bottom: 18px;
          font-size: 1.1em;
          color: #d72660;
          font-weight: 600;
        }
        .lapaclicker-new-stats > div {
          flex: 1;
          text-align: center;
        }
        .lapaclicker-new-btn {
          background: #fff;
          border: 2.5px solid #ffb6c1;
          border-radius: 50%;
          width: 110px;
          height: 110px;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 3.5em;
          margin: 18px 0 10px 0;
          cursor: pointer;
          transition: border 0.2s, background 0.2s;
          box-shadow: none;
        }
        .lapaclicker-new-btn:active {
          background: #ffe4ec;
          border-color: #ff69b4;
        }
        .lapaclicker-new-paw {
          font-size: 2.5em;
        }
        .lapaclicker-new-save {
          background: #ffe4ec;
          color: #d72660;
          border: none;
          border-radius: 12px;
          padding: 12px 0;
          width: 100%;
          font-size: 1.1em;
          font-weight: 600;
          margin-top: 8px;
          cursor: pointer;
          box-shadow: none;
          transition: background 0.2s;
        }
        .lapaclicker-new-save:active {
          background: #ffd1e3;
        }
    </style>
</head>
<body>
    <!-- Telegram Login Widget -->
    <!-- <div id="telegram-login-container"> ... </div> -->

    <a href="#" class="logo" onclick="showScreen('initial-welcome'); return false;">
        Лапули
        <span class="logo-age">12+</span>
    </a>

    <!-- Модальное окно для GPT промтов -->
    <div class="modal-overlay" id="gpt-modal">
        <div class="modal-content">
            <div class="modal-icon">🤖</div>
            <div class="modal-title">Coming Soon!</div>
            <div class="modal-text">Тематические промты для GPT находятся в разработке. Скоро здесь появятся полезные промты для работы с квестами!</div>
            <button class="modal-button" onclick="closeGptModal()">Понятно</button>
        </div>
    </div>
    
    <!-- Модальное окно для новостей "В разработке" -->
    <div class="modal-overlay" id="news-modal">
        <div class="modal-content">
            <div class="modal-icon">📰</div>
            <div class="modal-title">В разработке!</div>
            <div class="modal-text">Раздел новостей скоро появится для всех пользователей.<br>Следите за обновлениями!</div>
            <button class="modal-button" onclick="closeNewsModal()">Понятно</button>
        </div>
    </div>
    
    <div id="app">
        <!-- Новый начальный экран -->
        <div id="initial-welcome" class="screen active">
            <div class="welcome-screen">
                <h1 class="welcome-title">Добро пожаловать в QuestApp!</h1>
                <p class="welcome-subtitle">Ваш проводник в мир квестов! Здесь вы найдете информацию о квестах, сможете посмотреть свои лапабаллы и многое другое.<br/>Чтобы посмотреть свои лапабаллы, перейдите в раздел "Интерактив".</p>
                <div class="main-menu">
                    <button class="button" onclick="showScreen('start')">
                        <span class="emoji">🚀</span>
                        Начать
                    </button>
                </div>
            </div>
        </div>

        <!-- Начальный экран (теперь главное меню) -->
        <div id="start" class="screen">
            <div class="welcome-screen">
                <h1 class="welcome-title">Главное меню</h1>
                <p class="welcome-subtitle">Выберите интересующий раздел</p>
                <div class="main-menu">
                    <button class="button lapaclicker-main-btn" onclick="showLapaclicker()">
                        <span class="emoji">🐾</span>
                        ЛапаКликер
                    </button>
                    <button class="button" onclick="showScreen('project-selection')">
                        <span class="emoji">🎯</span>
                        Подбор проекта
                    </button>
                    <button class="button" onclick="showScreen('basic-info')">
                        <span class="emoji">📚</span>
                        Базовая информация
                    </button>
                    <button class="button" onclick="showScreen('encyclopedia')">
                        <span class="emoji">📖</span>
                        Энциклопедия
                    </button>
                    <button class="button" onclick="showScreen('advanced-info')">
                        <span class="emoji">🎓</span>
                        Продвинутая информация
                    </button>
                    <button class="button" onclick="showScreen('interactive')">
                        <span class="emoji">🎮</span>
                        Интерактив
                    </button>
                    <button class="button" onclick="openNews()">
                        <span class="emoji">📰</span>
                        Новости
                    </button>
                    <button class="button" onclick="showGptPrompts()">
                        <span class="emoji">🤖</span>
                        Тематические промты для GPT
                    </button>
                    <button class="button" id="admin-menu-btn" style="display:none" onclick="openAdminPanel()">
                        <span class="emoji">🛡️</span>
                        Админ-панель
                    </button>
                    <button class="button" onclick="showScreen('support')">
                        <span class="emoji">🛠️</span>
                        Тех. поддержка
                    </button>
                </div>
            </div>
        </div>

        <!-- Подбор проекта -->
        <div id="project-selection" class="screen">
            <div class="text-content">
                <h2>Отлично! Выберите интересующий вас жанр:</h2>
            </div>
            <button class="button" onclick="showScreen('action-games')">
                <span class="emoji">🏃</span>Экшен игры
            </button>
            <button class="button" onclick="showScreen('immersive')">
                <span class="emoji">🎭</span>Иммерсивные проекты
            </button>
            <button class="button" onclick="showScreen('escape')">
                <span class="emoji">🔐</span>Эскейпы
            </button>
            <button class="button" onclick="showScreen('maniac')">
                <span class="emoji">🔪</span>Маньячки
            </button>
            <button class="button" onclick="showScreen('mystic')">
                <span class="emoji">👻</span>Мистика
            </button>
            <button class="button" onclick="showScreen('mixed')">
                <span class="emoji">🎪</span>Смеси
            </button>
            <button class="button back-button" onclick="goBack()">
                <span class="emoji">⬅️</span>Назад
            </button>
        </div>

        <!-- Экшен игры -->
        <div id="action-games" class="screen">
            <div class="text-content">Да, их совсем немного!<br/>Если вам нравится экшен, есть возможность посетить версии других проектов, но в данном жанре:</div>
            <a class="button" href="https://telegra.ph/Proekt-Stress-06-16" target="_blank">Проект стресс 18+</a>
            <a class="button" href="https://telegra.ph/The-Last-of-Us-06-16-2" target="_blank">The last of us 18+</a>
            <a class="button" href="https://telegra.ph/Pryatki-v-Alkatrase-06-16" target="_blank">Прятки в Алькатрасе 18+</a>
            <button class="button back-button" onclick="goBack()"><span class="emoji">⬅️</span>Назад</button>
        </div>

        <!-- Иммерсивные проекты -->
        <div id="immersive" class="screen">
            <div class="text-content">Хороших иммерсивных проектов, к сожалению, также мало. И найти альтернативные версии в данном жанре будет значительно труднее</div>
            <a class="button" href="https://telegra.ph/Podozrenie-padaet-na-05-23" target="_blank">Подозрение падает на 14+</a>
            <a class="button" href="https://telegra.ph/Semejnyj-obet-05-23" target="_blank">Семейный обет 16+</a>
            <a class="button" href="https://telegra.ph/Insane-Paranoid-06-16" target="_blank">Insane Paranoid 16+</a>
            <a class="button" href="https://telegra.ph/Kto-ne-spryatalsya-06-16" target="_blank">Кто не спрятался 12+</a>
            <button class="button back-button" onclick="goBack()"><span class="emoji">⬅️</span>Назад</button>
        </div>

        <!-- Эскейпы -->
        <div id="escape" class="screen">
            <div class="text-content">А вот эскейпов уже значительно больше! Тут предоставлены лишь некоторые из них</div>
            <button class="button" onclick="showScreen('more-difficult')"><span class="emoji">⬆️</span>Более сложные</button>
            <button class="button" onclick="showScreen('less-difficult')"><span class="emoji">⬇️</span>Менее сложные</button>
            <button class="button back-button" onclick="goBack()"><span class="emoji">⬅️</span>Назад</button>
        </div>

        <!-- Более сложные эскейпы -->
        <div id="more-difficult" class="screen">
            <div class="text-content">Более сложные эскейпы:</div>
            <a class="button" href="https://telegra.ph/Obekt-Foris-06-16" target="_blank">Объект форис 16+</a>
            <a class="button" href="https://telegra.ph/Mech-korolya-Artura-06-16-2" target="_blank">Меч короля Артура 14+(10+)</a>
            <a class="button" href="https://telegra.ph/Desyat-negrityat-06-16" target="_blank">10 негритят 14+</a>
            <a class="button" href="https://telegra.ph/Vozdushnyj-plen-06-16" target="_blank">Воздушный плен 14+(10+)</a>
            <a class="button" href="https://telegra.ph/Vkus-nasledstva-06-16" target="_blank">Вкус наследства 14+(11+)</a>
            <button class="button back-button" onclick="goBack()"><span class="emoji">⬅️</span>Назад</button>
        </div>

        <!-- Менее сложные эскейпы -->
        <div id="less-difficult" class="screen">
            <div class="text-content">Менее сложные эскейпы:</div>
            <a class="button" href="https://telegra.ph/Nazad-v-SSSR-perezagruzka-06-16" target="_blank">Назад в СССР: перегрузка 14+(12+)</a>
            <a class="button" href="https://telegra.ph/Na-oshchup-06-16" target="_blank">На ощупь 14+(12+)</a>
            <a class="button" href="https://telegra.ph/7-zagadok-faraona-06-16" target="_blank">7 загадок фараона 14+(10+)</a>
            <a class="button" href="https://telegra.ph/Lavina-zabveniya-06-16" target="_blank">Лавина забвения 14+(8+)</a>
            <button class="button back-button" onclick="goBack()"><span class="emoji">⬅️</span>Назад</button>
        </div>

        <!-- Маньячки -->
        <div id="maniac" class="screen">
            <div class="text-content">С ними, к сожалению, тоже беда. При желании есть возможность пройти альтернативные маньячные версии на других проектах (Дед инсайд, мгла и сидр как пример)</div>
            <a class="button" href="https://telegra.ph/Povorot-ne-tuda-06-16" target="_blank">Поворот не туда 16+</a>
            <a class="button" href="https://telegra.ph/Nezvanye-gosti-06-16" target="_blank">Незваные гости 12+</a>
            <a class="button" href="https://telegra.ph/Proekt-Fatum-06-16" target="_blank">Проект Fatum 18+</a>
            <button class="button back-button" onclick="goBack()"><span class="emoji">⬅️</span>Назад</button>
        </div>

        <!-- Мистика -->
        <div id="mystic" class="screen">
            <div class="text-content">Проектов этого жанра огромное количество, на вкус и цвет</div>
            <a class="button" href="https://telegra.ph/Nightmares-06-16" target="_blank">Nightmares 14+</a>
            <a class="button" href="https://telegra.ph/The-Evil-Within-06-16" target="_blank">The Evil Within 16+</a>
            <a class="button" href="https://telegra.ph/Outlast-06-16" target="_blank">Outlast 16+</a>
            <a class="button" href="https://telegra.ph/Amnesia-06-16" target="_blank">Amnesia 16+</a>
            <a class="button" href="https://telegra.ph/Fear-06-16" target="_blank">Fear 16+</a>
            <a class="button" href="https://telegra.ph/Poltergejst-06-16" target="_blank">Полтергейст 16+</a>
            <a class="button" href="https://telegra.ph/Five-Nights-at-Freddys-06-16-2" target="_blank">Five Nights at Freddy's 18+(12+)</a>
            <a class="button" href="https://telegra.ph/Pila-06-16" target="_blank">Пила 16+</a>
            <a class="button" href="https://telegra.ph/Ono-06-16" target="_blank">Оно 16+</a>
            <a class="button" href="https://telegra.ph/Babadook-06-16" target="_blank">Babadook 15+(12+)</a>
            <a class="button" href="https://telegra.ph/Mgla-06-16" target="_blank">Мгла 16+(12+)</a>
            <a class="button" href="https://telegra.ph/Taro-karta-smerti-06-16" target="_blank">Таро: карта смерти 18+(16+)</a>
            <a class="button" href="https://telegra.ph/Iskateli-mogil-06-16" target="_blank">Искатели могил 14+</a>
            <button class="button back-button" onclick="goBack()"><span class="emoji">⬅️</span>Назад</button>
        </div>

        <!-- Смеси -->
        <div id="mixed" class="screen">
            <div class="text-content">Смеси включают в себя как элементы мистики, так и маньячки! Возможно наличие экшен-части</div>
            <a class="button" href="https://telegra.ph/Lechebnica-sv-Avena-06-16" target="_blank">Авен 14+</a>
            <a class="button" href="https://telegra.ph/Rage-06-16" target="_blank">Rage 16+</a>
            <a class="button" href="https://telegra.ph/Momo-06-16" target="_blank">Момо 14+</a>
            <a class="button" href="https://telegra.ph/Dead-Inside-06-16" target="_blank">Dead inside 12+</a>
            <a class="button" href="https://telegra.ph/Amerikanskaya-istoriya-uzhasov-06-16" target="_blank">Американская история ужасов 12+</a>
            <a class="button" href="https://telegra.ph/Strashnye-istorii-dlya-rasskazov-v-temnote-06-15" target="_blank">СИДР 12+</a>
            <a class="button" href="https://telegra.ph/SCP-06-15" target="_blank">Scp 14+</a>
            <a class="button" href="https://telegra.ph/Za-dengi---da-06-15" target="_blank">За деньги - да 14+(12+)</a>
            <button class="button back-button" onclick="goBack()"><span class="emoji">⬅️</span>Назад</button>
        </div>

        <!-- Базовая информация -->
        <div id="basic-info" class="screen">
            <div class="text-content">Мы разберем большую часть основных моментов и трудностей, которые чаще всего возникают у новичков

Материал достаточно объемный, так что в случае недопониманий: 

📌 Вопросы - @lapuly_quest

📌  Вопросы (анонимно) - <a href="https://t.me/anonimnyye_voprosy_bot?start=qwj6y" target="_blank">https://t.me/anonimnyye_voprosy_bot?start=qwj6y</a>

Выбирайте любую интересующую тему ниже!</div>
            <button class="button" onclick="showScreen('difficulty-level')">Уровень сложности</button>
            <button class="button" onclick="showScreen('age-restrictions')">Возрастные ограничения</button>
            <button class="button" onclick="showScreen('players-count')">Кол-во игроков</button>
            <button class="button" onclick="showScreen('time-passing')">Время прохождения</button>
            <button class="button" onclick="showScreen('quest-theme')">Тематика Квеста</button>
            <button class="button" onclick="showScreen('quest-history')">История появления квестов</button>
            <button class="button back-button" onclick="goBack()">Назад</button>
        </div>

        <!-- Уровень сложности -->
        <div id="difficulty-level" class="screen">
            <div class="text-content">Уровень сложности:

Так как квесты в реальности — это, прежде всего, игра, в них есть несколько уровней сложности. Вы можете выбрать легкий, средний или сложный квест. Чем же они различаются? Тут всё просто. Уровень сложности влияет на процесс самого квеста. В легком вас ждут простые и понятные задания, которые не требуют особых усилий или времени для прохождения. Сложный же квест, наоборот, будет наполнен множеством трудных задач, загадок и головоломок, с которыми просто так не справишься — придется приложить усилия. Поэтому если Вы отправляетесь на квест впервые — выбирайте легкий уровень. Так будет проще понять суть квестов в реальности как игры в целом, его принцип и цель. Если Вы уже не новичок — можете выбирать средний или сложный уровень. Тут уже зависит от предпочтений — кому-то нравятся сложные и запутанные задачки, а кто-то любит трудности в меру.</div>
            <button class="button back-button" onclick="goBack()"><span class="emoji">⬅️</span>Назад</button>
        </div>

        <!-- Возрастные ограничения -->
        <div id="age-restrictions" class="screen">
            <div class="text-content">Возрастные ограничения:

Многие говорят, что квесты подходят всем. Однако на деле это не совсем так. Далеко не все квесты охватывают одновременно все возраста. Зачастую бывает так, что квесты разделяют на детские и взрослые. Именно поэтому на каждом квесте обычно указывается возрастное ограничение. Конечно, бывают и квесты без возрастных ограничений. Поэтому смело можно организовать досуг сразу для всей семьи, и каждому будет интересно.</div>
            <button class="button back-button" onclick="goBack()"><span class="emoji">⬅️</span>Назад</button>
        </div>

        <!-- Кол-во игроков -->
        <div id="players-count" class="screen">
            <div class="text-content">Количество игроков:

Это еще один принцип, по которому различаются квесты в реальности. Чаще всего в квестах может принять участие от 2 до 4 игроков. Но некоторые игры позволяют проходить комнаты даже одному или в очень большой компании. Обычно количество игроков тесно сопряжено с сюжетом квеста, обилию загадок и уровнем сложности. Логично, что в легких квестах не требуется внимание целой толпы, и такую игру может пройти один участник. А вот если сюжет действительно сложный  и требует повышенного внимания — то тут чем больше глаз, тем лучше. Однако не все любят проходить квесты в большой компании. И это тоже учитывается при создании квестов. Чаще всего, их проходят вдвоем или вчетвером. Поэтому это наиболее встречающиеся варианты разбивки игроков: от 2 до 4 человек.</div>
            <button class="button back-button" onclick="goBack()"><span class="emoji">⬅️</span>Назад</button>
        </div>

        <!-- Время прохождения -->
        <div id="time-passing" class="screen">
            <div class="text-content">Время прохождения:

В принципе, все вышеуказанное зачастую влияет и на общую протяженность квеста. Чаще всего, квест в реальности длится 60 минут. Но есть и те, которые ограничены 40 минутами или, наоборот, 90. Тут всё зависит, опять же-таки от того, насколько сложный квест и сколько игроков в него могут играть одновременно. Кому-то может показаться, что 60 минут — слишком много. Однако в процессе игры это время всегда проходит незаметно, и Вы даже можете не успеть пройти квест за это время. Так что если Вы особенно усидчивый и трепетно относитесь к деталям — выбирайте тот квест, который длится подольше.</div>
            <button class="button back-button" onclick="goBack()"><span class="emoji">⬅️</span>Назад</button>
        </div>

        <!-- Тематика квеста -->
        <div id="quest-theme" class="screen">
            <div class="text-content">Тематика квеста:

Пожалуй, это самая интересная классификация квестов. И ее мы разберем наиболее подробно. Если с количеством игроков и возрастными ограничениями все ясно, то тематика и жанр квестов — одна из интереснейших особенностей. И тут есть несколько подводных камней, в которых стоит разобраться детально. Знание тем квестов поможет Вам максимально точно определиться с выбором и найти игру по душе.</div>
            <button class="button" onclick="showScreen('genres')"><span class="emoji">🎭</span>Жанры</button>
            <button class="button back-button" onclick="goBack()"><span class="emoji">⬅️</span>Назад</button>
        </div>

        <!-- Жанры -->
        <div id="genres" class="screen">
            <div class="text-content">Каждый квест относится к определенному жанру. Существует множество классификаций, но мы постараемся кратко описать основные 

Разбираться в жанрах важно, чтобы понимать свои предпочтения и исходя из этого выбирать проекты</div>
            <button class="button" onclick="showScreen('main-categories')"><span class="emoji">🗝️</span>Основные категории</button>
            <button class="button" onclick="showScreen('additional-categories')"><span class="emoji">➕</span>Дополнительные категории</button>
            <button class="button back-button" onclick="goBack()"><span class="emoji">⬅️</span>Назад</button>
        </div>

        <!-- Основные категории -->
        <div id="main-categories" class="screen">
            <div class="text-content">
                🔐Классический квест («эскейп-рум») - классический квест, где вы оказываетесь в помещении, полном загадок и головоломок. Задача - выбраться за отведенное время, используя найденные предметы и подсказки 


                🏃Экшн-игра - направление, требующее физической активности и взаимодействий, скорости, реакции. Часто присутствуют элементы поиска предметов и соревновательный характер


                🎭Перфоманс - интерактивная игра с участием актеров, где игроки становятся главными героями. Жанр подразумевает взаимодействие с персонажами, влияющих на развитие событий, и театральные сцены.  

                Перфоманс имеет множество разветвлений:

                1). Мистика - характеризуется необъяснимыми явлениями, сверхъестественными элементами и акцентом на скримерах 

                2). Маньячка - отличается преследованием, постоянным напряжением и угрозой со стороны персонажа. Акцент на динамике, интерактиве и словесном и не только контакте  

                3). Иммерсивки - интерактивное театральное представление, где игроки погружаются в сюжет и становятся участниками событий. Акцент на сценарии, актерской игре и взаимодействии 

                4). Смеси -квест может содержать в себе элементы нескольких жанров</div>
            <button class="button back-button" onclick="goBack()"><span class="emoji">⬅️</span>Назад</button>
        </div>

        <!-- Дополнительные категории -->
        <div id="additional-categories" class="screen">
            <div class="text-content">Многие квесты предлагают не только классическую версию, но и другие варианты для повторных посещений:

Экшн-версия - версия, персонажи которой уже знакомы вам из классической игры. Отличается большим количеством физической активности и взаимодействий

Альтернативная версия - совершенно новая игра, не имеющая ничего общего с оригинальным сюжетом. Полностью меняется история, появляются новые персонажи, и меняется цепочка действий.</div>
            <button class="button back-button" onclick="goBack()"><span class="emoji">⬅️</span>Назад</button>
        </div>

        <!-- История появления квестов -->
        <div id="quest-history" class="screen">
            <div class="text-content">История появления квестов:

Квест (в переводе с анг. «quest» – «поиск») – это интерактивная игра с увлекательной сюжетной линией. Ее участники попадают в закрытое помещение, из которого нужно выбраться за 60 минут. Сегодня эскейп-комнатами в реальности уже никого не удивишь, а их разнообразие увеличивается с каждым годом. Почему квесты получили такую популярность, и какова история их развития?


Впервые о них услышали в 60-х годах прошлого столетия благодаря компьютерной игре «Crimson Rооm». Главный герой, оказавшийся взаперти красной комнаты, должен был выбраться наружу, используя при этом элементы интерьера. Все 13 предметов были связаны между собой единой логической цепочкой. Геймеры часами просиживали у компьютера, проверяя свою сообразительность. В течение нескольких лет вышел целый ряд виртуальных квестов с более закрученным сюжетом: «Viridian Rооm», «Blue Chamber» и «White Chamber».


Позднее, когда вычислительная техника достигла следующего этапа развития, возникло новое направление – графические квесты. Первой компьютерной игрой в жанре приключений стала «Mystery House», выпущенная в 1980 году. Эскейп-рум был создан по мотивам книги Агаты Кристи «Десять негритят» и разошелся тиражом в несколько тысяч экземпляров. От обычных игр он отличался наличием декоративных иллюстраций. Игрок по-прежнему управлял персонажем в то время, как статичное изображение стимулировало его фантазию. Спустя несколько лет фирма LucasArts полностью отошла от текстового интерфейса, оперируя рисованными объектами и насыщенным цветовым оформлением.


Однако программистам не могло прийти в голову, что спустя полстолетия виртуальные сценарии преобразуются в реальные истории, завоевав признание миллионов людей по всему миру. В какой-то момент компьютерные игры показались геймерам невероятно скучными. В начале 2000-хх годов у них появилась идея создания реалити-квеста, что вывело развлекательную индустрию на новый уровень. После Китая и Японии такие игры начали появляться на территории стран Европы и СНГ. Первые эскейп-комнаты были построены на базе хостелов и квартир, имели скудный интерьер и незамысловатые загадки.

 

На территории России первый квест был оборудован сравнительно недавно – в 2013 году. Его первооткрывателем стал московский бизнесмен Сергей Кузнецов, основатель  известной компании «Клаустрофобия». Эскейп-комната была оформлена в стиле психиатрической больницы и обошлась в 1,2 млн. руб. С ростом инвестирования локации подвергались ремонту. Как сознаются разработчики, их первые квесты были самыми лучшими. Несмотря на то, что проект рассматривался, как кратковременное развлечение, игры имели сильную сюжетную линию с завязкой и кульминаций. Партнеры рассчитывали, что вложения окупятся лишь через год-полтора, но деньги вернулись уже через два месяца. Отбоя от желающих найти выход из закрытой комнаты не было, несмотря на то, что организаторы не вкладывались в рекламу.

 

В течение следующих двух лет подобный вид развлечения на территории России стал очень популярным. Предприниматели поняли, что здесь освободилась ниша для прибыльного бизнеса. Всего два-три месяца – и небольшое вложение окупится с лихвой. Присмотревшись к создателям «Клаустрофобии», они начали развивать свою деятельность по франшизе. Реалити-квесты стали открываться в Санкт-Петербурге, Новосибирске, Екатеринбурге, Омске. С появлением конкурентов рынок переполнился. Сегодня в России существует более 200 компаний, которым принадлежат около 900 эскейп-комнат. Еще 250 локаций ждут своего открытия в ближайшем будущем. Их создатели придумывают изощренные головоломки для желающих пощекотать нервы. А легендарная «Клаустрофобия» планирует продавать франшизу в Европу и Америку.</div>
            <button class="button back-button" onclick="goBack()"><span class="emoji">⬅️</span>Назад</button>
        </div>

        <!-- Продвинутая информация -->
        <div id="advanced-info" class="screen">
            <div class="text-content">Мы разберем большую часть основных моментов и трудностей, которые чаще всего возникают у новичков

Материал достаточно объемный, так что в случае недопониманий: 

📌 Вопросы - @lapuly_quest

📌  Вопросы (анонимно) - <a href="https://t.me/anonimnyye_voprosy_bot?start=qwj6y" target="_blank">https://t.me/anonimnyye_voprosy_bot?start=qwj6y</a>

Выбирайте любую интересующую тему ниже!</div>
            <button class="button" onclick="showScreen('first-quest')">Подбор первого квеста</button>
            <button class="button" onclick="showScreen('booking')">Бронь</button>
            <button class="button" onclick="showScreen('special-versions')">Спецухи</button>
            <button class="button" onclick="showScreen('tgk-communities')">Тгк, сообщества</button>
            <button class="button" onclick="showScreen('team-search')">Поиск команды</button>
            <button class="button back-button" onclick="goBack()">Назад</button>
        </div>

        <!-- Подбор первого квеста -->
        <div id="first-quest" class="screen">
            <div class="text-content">Выбор первого проекта - самая сложная задача: нет опыта и не с чем сравнивать.

Важно запомнить несколько моментов:

1. Использование квест-агрегаторов:

Вариант кажется удобным. Однако большинство функций не работает должным образом: фильтрация некорректная, рейтинги не объективны, а характеристики не всегда соответствуют действительности. Риск ошибиться в выборе высок

2. Использование сообществ:

Более надежный, хоть и трудозатратный способ: живые отзывы, подборки, новинки, возможность обсуждения проекта с другими игроками

3. Личные предпочтения:

Даже если вам удалось выбрать квест, опираясь на качество, - это 50% успеха. Что вы хотите получить по итогу? Эмоции, адреналин, сюжет? Учитывайте ваш настрой и желанное послевкусие. Попробуйте подумать, какая тематика и жанр вам нравится.

Приятное первое впечатление - залог дальнейшего погружения в сферу!</div>
            <button class="button back-button" onclick="goBack()"><span class="emoji">⬅️</span>Назад</button>
        </div>

        <!-- Бронь -->
        <div id="booking" class="screen">
            <div class="text-content">Выбери способ бронирования</div>
            <button class="button" onclick="showScreen('aggregators')">Агрегаторы</button>
            <button class="button" onclick="showScreen('curatorship')">Кураторство</button>
            <button class="button" onclick="showScreen('independently')">Самостоятельно</button>
            <button class="button" onclick="showScreen('company-sites')">Сайты компаний</button>
            <button class="button back-button" onclick="goBack()"><span class="emoji">⬅️</span>Назад</button>
        </div>

        <!-- Агрегаторы -->
        <div id="aggregators" class="screen">
            <div class="text-content">Большинство поначалу обращается к агрегаторам, не зная о других вариантах. Отдельные же сайты компаний пользуются спросом меньше.

Мы расскажем о нескольких и обозначим, почему с нашей стороны это не лучший вариант</div>
            <button class="button" onclick="showScreen('quest-world')">Мир квестов</button>
            <button class="button back-button" onclick="goBack()"><span class="emoji">⬅️</span>Назад</button>
        </div>

        <!-- Мир квестов -->
        <div id="quest-world" class="screen">
            <div class="text-content">Мир квестов (мк) - это агрегатор квестов в реальности, перформансов, экшн-игр, ролевых и VR. Платформа предоставляет возможность ознакомиться с большим кол-вом проектов и забронировать моментально. Также есть система квестобаллов, присутствуют различные скидки и акции, но будьте внимательны:

➕ Приятная система лояльности - квестобаллы

➖ Возрастные ограничения могут отличаться от информации на других ресурсах

➖ Формат игр более формальный и напряженный

➖ Контакт как с актерами, так и с другими игроками после игры затруднен

➖ Нет возможности посещать альтернативные, экшн и спец. версии

Для просмотра изменений очень удобно, однако к использованию в качестве подбора квеста не рекомендую, есть более надежные способы</div>
            <button class="button back-button" onclick="goBack()"><span class="emoji">⬅️</span>Назад</button>
        </div>

        <!-- Кураторство -->
        <div id="curatorship" class="screen">
            <div class="text-content">Куратор - это как правило опытный игрок, актер или управляющий, который поможет сориентироваться, подобрать и забронировать проект, учитывая пожелания

Тебе всегда будет, к кому обратиться по любому вопросу: есть возможность запросить определенный актерский состав, альтернативную версию квеста и многое другое.

Подобрать куратора не так трудно благодаря сообществам и тг-каналам (они все размещены в боте!), достаточно просто написать лично. Но будьте аккуратны: некоторые ведут себя навязчиво и предлагают лишь "свои" проекты или обижаются и ведут себя по-детски в иных случаях

Однако для большинства игроков это лучший вариант. Главное - найти подходящего человека!

Если хотите хорошего и щедрого куратора пишите: <a href="https://t.me/catalyne" target="_blank">@catalyne</a></div>
            <button class="button back-button" onclick="goBack()"><span class="emoji">⬅️</span>Назад</button>
        </div>

        <!-- Самостоятельно -->
        <div id="independently" class="screen">
            <div class="text-content">При таком раскладе человек сам занимается подбором, договаривается обо всем и бронирует напрямую через актера/управа определенного проекта

У новичков это может вызывать трудности, но в дальнейшем появляется огромное количество новых знакомств, связей и преимуществ - ты не зависишь ни от кого

Данный способ подходит далеко не всем. Он требует сил и времени, но открывает множество возможностей в будущем. Хотите полной свободы - ваш вариант!</div>
            <button class="button back-button" onclick="goBack()"><span class="emoji">⬅️</span>Назад</button>
        </div>

        <!-- Сайты компаний -->
        <div id="company-sites" class="screen">
            <div class="text-content">Каждый проект закреплен за какой-либо компанией. Их сайтов не так много: практически все размещены в тг-каналах. Horror Universe, You Can Play и PopCorp - наиболее популярные примеры.

Практической ценности и новой информации они особо не содержат и спросом пользуются уже меньше

Однако отлично подойдут в качестве просмотра изменений, новинок, цен и слотов</div>
            <button class="button back-button" onclick="goBack()"><span class="emoji">⬅️</span>Назад</button>
        </div>

        <!-- Спецухи -->
        <div id="special-versions" class="screen">
            <div class="text-content">Спецверсия - это временный эксклюзивный сюжет, поставленный на локации какого-либо квеста. Идет как правило пару дней, и повторы крайне редки

Успеть забрать хороший слот бывает проблематично. Если спецверсии этого человека/команды пользуются спросом, сделать это будет ещё сложнее. Обычно заранее анонсируют четкое время, когда будет открыто бронирование

Однако даже при отсутствии слотов есть шанс попасть на игру: многие ребята начинает активно искать себе игроков в команду

О поиске сокомандников вся информация доступна в другом блоке❗️</div>
            <button class="button" onclick="showScreen('special-versions-details')">Подробнее</button>
            <button class="button back-button" onclick="goBack()"><span class="emoji">⬅️</span>Назад</button>
        </div>

        <!-- Подробнее спецуха -->
        <div id="special-versions-details" class="screen">
            <div class="text-content">Спецверсиями занимается огромное количество людей. Они все совершенно разные по концепции, жанру, актерскому составу и ценнику.

Будьте осторожны при выборе! Мы бы выделили пару ребят:

💥WoodEvil - команда ребят, занимающаяся постановкой и организацией развлекательных и квест-мероприятий. Ставят реально классные спецухи, которые пользуются спросом: удобные слоты сразу же разлетается

🎭Immersive New Era - творческое объединение, специализирующееся на иммерсивных жанрах. Попасть на их спецверсии крайне сложно, но можно попытать удачу с поиском сокомандников

🖇️Special Squad - ещё одно творческое объединение с богатым опытом в различных жанрах квестов. Ставят спецухи совершенно разного характера

👹Стресс с Грин стрит - а точнее спецверсии Тоши! Проводятся стабильно 1-2 раза в месяц, обычно разных жанров. Попасть чуть проще, чем на вышеприведенные примеры

Всю информацию, отзывы и анонсы спецверсий можно найти в тгк у ребят!

————————

Важно! Учитывайте жанр игры при выборе: даже высококачественная спецуха может не понравиться, если не будет соответствовать вашим предпочтениям

💥WoodEvil
<a href="https://t.me/woodevil_quest" target="_blank">https://t.me/woodevil_quest</a>

🎭Immersive New Era
<a href="https://t.me/ImmersiveNewEra" target="_blank">https://t.me/ImmersiveNewEra</a>

🖇️Special Squad
<a href="https://t.me/questgde" target="_blank">https://t.me/questgde</a>

👹Стресс с Грин стрит
<a href="https://t.me/stress_s_green_street" target="_blank">https://t.me/stress_s_green_street</a>

Анонсы всех спецверсий, чьи ссылки указаны выше, будут продублированы в боте

📌 Но все же подписываемся!
иногда у них появляются крутые интерактивчики, конкурсы и видео</div>
            <button class="button back-button" onclick="goBack()"><span class="emoji">⬅️</span>Назад</button>
        </div>

        <!-- Тгк, сообщества -->
        <div id="tgk-communities" class="screen">
            <div class="text-content">В ТГ существуют множество сообществ, каналов и прочих групп, связанных с квестами. Как правило это каналы компаний, оргов/актеров или просто игроков. В них можно найти обзоры, интервью, конкурсы, анонсы, новости, различные видео и просто познакомиться со многими классными ребятами!
Мы выделим пару, но тут излишне на вкус и цвет

———- (прочие тгк и сообщ)

🎀 Лапули (рубрики для новичков, рецензии, интервью, квизы, интерактив, разные видосы и непосредственно канал данного тг-бота!)
<a href="https://t.me/lapuliquest" target="_blank">https://t.me/lapuliquest</a>

🔦 Подслушка (отзывы, анонсы, новости, обсуждения, поиск команды)
<a href="https://t.me/podslushano_quest" target="_blank">https://t.me/podslushano_quest</a>

🎥 У страха есть камеры (все о продаже нереально крутых квестовых видосов с камер, ламповые стримы прямо с игр и бесконечные истории)
<a href="https://t.me/questvsn" target="_blank">https://t.me/questvsn</a>

🕊️ Мир глазами голубя (рецензии, интервью, конкурсы)
<a href="https://t.me/MirGolubia" target="_blank">https://t.me/MirGolubia</a>

🩸 Подворотня квестов
(Рецензии, видео ответы на вопросы, тайный санта, треки и прочие рубрики!)
<a href="https://t.me/podvorotnya_quest" target="_blank">https://t.me/podvorotnya_quest</a>

🦄 Долбаный космос (классные квизы, собирающие преимущественно квестовых ребят, отзывы, истории и просто уютная атмосфера)
<a href="https://t.me/kosmosAlya" target="_blank">https://t.me/kosmosAlya</a>

🤲🏻 Quest, only about quests (наборы на квесты, поиск сокомандников,акции и отзывы)
<a href="https://t.me/ruslan_kvest2024" target="_blank">https://t.me/ruslan_kvest2024</a>

😂 Квестовые мемы
<a href="https://t.me/tpquest" target="_blank">https://t.me/tpquest</a>

👺 Маски квестовой индустрии
<a href="https://t.me/MaskBad" target="_blank">https://t.me/MaskBad</a>

Также есть разные тгк актеров, где бывает проскакивает информация по проектам, но их слишком много📌</div>
            <button class="button" onclick="showScreen('companies')">Компании</button>
            <button class="button back-button" onclick="goBack()"><span class="emoji">⬅️</span>Назад</button>
        </div>

        <!-- Компании -->
        <div id="companies" class="screen">
            <div class="text-content">Основные тгк квест-компаний!

🦇 Scary Place
<a href="https://t.me/ScaryPlaceQuest" target="_blank">https://t.me/ScaryPlaceQuest</a>

🩸 Horror Universe
<a href="https://t.me/horror_universee" target="_blank">https://t.me/horror_universee</a>

🌝 You Can Play
<a href="https://t.me/ycplay" target="_blank">https://t.me/ycplay</a>

👨‍🏫 Freakmeout
<a href="https://t.me/freakmeout_quest" target="_blank">https://t.me/freakmeout_quest</a>

🍿 PopCorp
<a href="https://t.me/popcorpquest" target="_blank">https://t.me/popcorpquest</a>

🔪 GrimTeam
<a href="https://t.me/grimteam_official" target="_blank">https://t.me/grimteam_official</a>

☠️ Tangle Quest
<a href="https://t.me/tanglequestofficia" target="_blank">https://t.me/tanglequestofficia</a>

🃏 Panic Room
<a href="https://t.me/PANIICROOM" target="_blank">https://t.me/PANIICROOM</a>

👻 Horror Bunker
<a href="https://t.me/HORROR_BUNKER" target="_blank">https://t.me/HORROR_BUNKER</a>

🦁 Royal Family
<a href="https://t.me/royalfamily_quest" target="_blank">https://t.me/royalfamily_quest</a>

🔓 Мир квестов
<a href="https://t.me/mirkvestovru" target="_blank">https://t.me/mirkvestovru</a>

🗝️ Клаустрофобия
<a href="https://t.me/claustrophobiaworld" target="_blank">https://t.me/claustrophobiaworld</a>

🌹 Crowded Room
<a href="https://t.me/crowdedroomCR" target="_blank">https://t.me/crowdedroomCR</a>

🥸 Noname Company
<a href="https://t.me/NoName_comp" target="_blank">https://t.me/NoName_comp</a>

🚀 Questart
<a href="https://t.me/questartgame" target="_blank">https://t.me/questartgame</a>

🪓 Woodevil
<a href="https://t.me/woodevil_quest" target="_blank">https://t.me/woodevil_quest</a>

🪭 Инкубо
<a href="https://t.me/incubo_quest_moscow" target="_blank">https://t.me/incubo_quest_moscow</a></div>
            <button class="button back-button" onclick="goBack()"><span class="emoji">⬅️</span>Назад</button>
        </div>

        <!-- Поиск команды -->
        <div id="team-search" class="screen">
            <div class="text-content">Есть несколько ресурсов, с помощью которых можно найти сокомандников

Подслушка тг/вк (возможно откликнуться на чужой запрос или создать свой)
<a href="https://t.me/podslushano_quest" target="_blank">https://t.me/podslushano_quest</a>

Поиск команды вк (возможно откликнуться на чужой запрос или создать свой)
<a href="https://vk.com/team_quests" target="_blank">https://vk.com/team_quests</a>

Quest, only about quests тг (проходит набор раз в период на определенный проект, бывают акции, можно создать свой запрос)
<a href="https://t.me/ruslan_kvest2024" target="_blank">https://t.me/ruslan_kvest2024</a>

Закулисье квестов тг
(небольшой чат с возможностью поиска сокомандников)
<a href="https://t.me/+bOI9X2_TSKplZDFi" target="_blank">https://t.me/+bOI9X2_TSKplZDFi</a></div>
            <button class="button back-button" onclick="goBack()"><span class="emoji">⬅️</span>Назад</button>
        </div>

        <!-- Интерактив -->
        <div id="interactive" class="screen">
            <div class="text-content">Выберите интересующий вас интерактивный контент</div>
            <button class="button" onclick="showScreen('google-sheets')">Посмотреть свои лапабаллы</button>
            <button class="button back-button" onclick="goBack()">Назад</button>
        </div>

        <!-- Google таблицы -->
        <div id="google-sheets" class="screen">
            <div class="text-content">
                <h2>Лапабаллы пользователей</h2>
                <div id="lapabalts-data" class="lapabalts-container">
                    <p>Загрузка данных...</p>
                </div>
            </div>
            <button class="button back-button" onclick="goBack()"><span class="emoji">⬅️</span>Назад</button>
        </div>

        <!-- Тех. поддержка -->
        <div id="support" class="screen">
            <div class="text-content">Bot by <a href="https://t.me/lapuliquest" target="_blank">https://t.me/lapuliquest</a><br/><br/>Idea @j_S_T_R, @makcgrechenkov<br/>Code @svedushev</div>
            <button class="button" onclick="showScreen('bot-issues')"><span class="emoji">⚠️</span>В боте что-то не работает</button>
            <button class="button" onclick="showScreen('user-agreement')"><span class="emoji">📄</span>Пользовательское соглашение</button>
            <button class="button back-button" onclick="goBack()"><span class="emoji">⬅️</span>Назад</button>
        </div>

        <!-- В боте что-то не работает -->
        <div id="bot-issues" class="screen">
            <div class="text-content">Если у вас возникли проблемы с ботом, пожалуйста, напишите нам в поддержку: <a href="https://t.me/lapuly_quest" target="_blank">@lapuly_quest</a></div>
            <button class="button back-button" onclick="goBack()"><span class="emoji">⬅️</span>Назад</button>
        </div>

        <!-- Пользовательское соглашение -->
        <div id="user-agreement" class="screen">
            <div class="text-content">
                <h2>Пользовательское соглашение Telegram-мини-приложения QuestApp</h2>

                <p><b>Дата последнего обновления:</b> 17 июня 2025 г.</p>

                <p>Настоящее Пользовательское соглашение (далее — «Соглашение») определяет условия использования Telegram-мини-приложения QuestApp (далее — «Приложение»), созданного физическим лицом (далее — «Владелец»), и представляет собой юридически обязательное соглашение между Владельцем и любым пользователем Приложения (далее — «Пользователь»).</p>

                <h3>1. Описание Приложения</h3>
                <p>Приложение предназначено для помощи новичкам и опытным игрокам в квест-индустрии. Оно реализовано как Telegram-мини-приложение и связано с телеграм-каналом, посвящённым квестам. В частности, приложение отображает рейтинг игроков по количеству так называемых «лапабаллов» (внутренних баллов активности), помогает отслеживать активность участников и вовлекает в игровой процесс.</p>

                <h3>2. Условия использования</h3>
                <ul>
                    <li>Использование Приложения допускается с 12 лет и старше.</li>
                    <li>Приложение предназначено только для личного, некоммерческого использования.</li>
                    <li>Пользователь соглашается с тем, что использование Приложения осуществляется добровольно и «как есть».</li>
                </ul>

                <h3>3. Сбор и обработка данных</h3>
                <p>Приложение собирает и обрабатывает минимальный объём персональных данных, строго необходимый для функционирования:</p>
                <ul>
                    <li>Telegram-юзернейм (если он есть)</li>
                    <li>Количество набранных лапабаллов (внутренние игровые очки)</li>
                </ul>
                <p>Эти данные не передаются третьим лицам, не продаются, не публикуются публично и используются исключительно для отображения рейтинга в рамках Приложения.</p>
                <p>Данные хранятся в Google Таблицах, к которым имеет доступ только Владелец.</p>

                <h3>4. Интеграции</h3>
                <p>Приложение использует:</p>
                <ul>
                    <li>Google Таблицы — для хранения игровой информации.</li>
                    <li>Потенциальную интеграцию с платформой «Мир Квестов» (если такая появится в будущем).</li>
                </ul>

                <h3>5. Ограничение ответственности</h3>
                <ul>
                    <li>Владелец не несёт ответственности за сбои в работе Telegram или сторонних сервисов (Google и др.).</li>
                    <li>Владелец не гарантирует непрерывную или безошибочную работу Приложения.</li>
                    <li>Пользователь самостоятельно несёт ответственность за использование Приложения в соответствии с законами своей страны.</li>
                </ul>

                <h3>6. Интеллектуальная собственность</h3>
                <p>Все тексты, логика работы и структура Приложения являются интеллектуальной собственностью Владельца. Запрещается копировать, воспроизводить или использовать элементы Приложения без письменного разрешения Владельца.</p>

                <h3>7. Заключительные положения</h3>
                <ul>
                    <li>Владелец оставляет за собой право изменять настоящее Соглашение в любое время. Актуальная версия будет доступна по ссылке внутри Приложения или на официальной странице.</li>
                    <li>Продолжая использование Приложения, Пользователь автоматически соглашается с новой версией Соглашения.</li>
                </ul>

                <h3>Связь с владельцем</h3>
                <p>По всем вопросам, касающимся использования Приложения или настоящего Соглашения, Пользователь может обращаться к Владельцу по следующим контактным данным:</p>
                <ul>
                    <li>Владелец: физическое лицо, зарегистрированное в г. Москва, Россия.</li>
                    <li>Контакт в Telegram: <a href="https://t.me/lapuly_quest" target="_blank">@lapuly_quest</a></li>
                </ul>
            </div>
            <button class="button back-button" onclick="goBack()"><span class="emoji">⬅️</span>Назад</button>
        </div>

        <!-- Новости -->
        <div id="news" class="screen">
            <div class="text-content">
                <h2>📰 Новости</h2>
                <div id="news-container">
                    <p>Загрузка новостей...</p>
                </div>
            </div>
            <button class="button back-button" onclick="goBack()">
                <span class="emoji">⬅️</span>Назад
            </button>
        </div>

        <!-- ЛапаКликер -->
        <div id="lapaclicker" class="screen">
            <div class="lapaclicker-bg">
                <div class="lapaclicker-card">
                    <h2 class="lapaclicker-title">🐾 ЛапаКликер</h2>
                    <div id="lapaclicker-auth" class="lapaclicker-auth" style="display:none;">
                        <label for="lapaclicker-username">Введите ваш ник (Telegram username):</label><br>
                        <input type="text" id="lapaclicker-username" placeholder="Ваш ник">
                        <button class="lapaclicker-btn" onclick="lapaclickerStart()">Начать</button>
                    </div>
                    <div id="lapaclicker-game" class="lapaclicker-game" style="display:none;">
                        <button class="lapaclicker-btn save-btn" onclick="saveResult()">💾 Сохранить результат</button>
                        <div class="lapaclicker-stats">
                            <div class="lapaclicker-stat"><span>👤</span> <span id="lapaclicker-user"></span></div>
                            <div class="lapaclicker-stat"><span>🏆</span> Макс: <span id="lapaclicker-max"></span></div>
                            <div class="lapaclicker-stat"><span>🐾</span> Клики: <span id="lapaclicker-count">0</span></div>
                        </div>
                        <button class="lapaclicker-btn click-btn" onclick="lapaclickerClick()">
                            <span class="paw-emoji">🐾</span>
                            <span class="click-text">Кликни лапу!</span>
                        </button>
                    </div>
                </div>
            </div>
            <button class="button back-button" onclick="goBack()"><span class="emoji">⬅️</span>Назад</button>
        </div>

        <!-- Энциклопедия6 -->
        <div id="encyclopedia" class="screen">
            <div class="text-content">
                <h2>Энциклопедия</h2>
                <div id="encyclopedia-list">
                    <button class="button" onclick="showEncycloDef(1)">Мир квестов (МК, мирок)</button>
                    <button class="button" onclick="showEncycloDef(2)">Клаустрофобия (клаусы)</button>
                    <button class="button" onclick="showEncycloDef(3)">Мк команды (мкшники)</button>
                    <button class="button" onclick="showEncycloDef(4)">Лимонницы/лимонники</button>
                    <button class="button" onclick="showEncycloDef(5)">Quest Stars (кусты)</button>
                    <button class="button" onclick="showEncycloDef(6)">Quest Vision (квест вижин)</button>
                    <button class="button" onclick="showEncycloDef(7)">Голубь</button>
                    <button class="button" onclick="showEncycloDef(8)">Зелень (зеленка)</button>
                    <button class="button" onclick="showEncycloDef(9)">ФОП спецухи</button>
                    <button class="button" onclick="showEncycloDef(10)">Электрозавод (завод)</button>
                    <button class="button" onclick="showEncycloDef(11)">ИГС, АХС и тд</button>
                    <button class="button" onclick="showEncycloDef(12)">Куратор</button>
                    <button class="button" onclick="showEncycloDef(13)">Купонные квесты (фс)</button>
                    <button class="button" onclick="showEncycloDef(14)">Биглион</button>
                    <button class="button" onclick="showEncycloDef(15)">Индивидуальное задание (индива, индивидуалка)</button>
                    <button class="button" onclick="showEncycloDef(16)">Обзорщики</button>
                    <button class="button" onclick="showEncycloDef(17)">Спецверсия (спецуха)</button>
                    <button class="button" onclick="showEncycloDef(18)">Альтернативная версия (альтернативка)</button>
                    <button class="button" onclick="showEncycloDef(19)">Фейс ту Фейс</button>
                    <button class="button" onclick="showEncycloDef(20)">Подслушка (пки)</button>
                    <button class="button" onclick="showEncycloDef(21)">Контакт</button>
                    <button class="button" onclick="showEncycloDef(22)">Морковка</button>
                    <button class="button" onclick="showEncycloDef(23)">Экшен часть (экшен)</button>
                    <button class="button" onclick="showEncycloDef(24)">Госты</button>
                </div>
            </div>
            <div id="encyclopedia-def" style="display:none;"></div>
            <button class="button back-button" id="encyclopedia-back"><span class="emoji">⬅️</span>Назад</button>
        </div>
    </div>

    <div class="footer">
        <p id="footer-version"></p>
        <p>© 2024-2025 Лапули. Все права защищены.</p>
    </div>

    <!-- Админ-панель (скрыта по умолчанию) -->
    <div id="admin-panel" style="display: none;">
        <h2>🔧 Админ-панель</h2>
        <div class="admin-form">
            <h3>📊 Изменить лапабаллы</h3>
            <input type="text" id="admin-username" placeholder="Telegram username (без @)">
            <input type="number" id="admin-lapabalts" placeholder="Новое количество баллов">
            <button onclick="updateLapabalts()">💾 Сохранить</button>
        </div>
        <div class="admin-form">
            <h3>📢 Создать новость</h3>
            <textarea id="admin-news-text" placeholder="Текст новости..."></textarea>
            <button onclick="createNews()">📤 Опубликовать</button>
        </div>
        <button class="button back-button" onclick="closeAdminPanel()"><span class="emoji">⬅️</span>Закрыть</button>
    </div>

    <script>
        let tg = window.Telegram.WebApp;
        let history = ['initial-welcome'];
        let currentUser = null;
        
        // Список экранов с белым фоном
        const whiteBgScreens = [
            'project-selection', 'action-games', 'immersive', 'escape', 'more-difficult', 'less-difficult', 'maniac', 'mystic', 'mixed',
            'basic-info', 'difficulty-level', 'age-restrictions', 'players-count', 'time-passing', 'quest-theme', 'genres', 'main-categories', 'additional-categories', 'quest-history',
            'advanced-info', 'first-quest', 'booking', 'aggregators', 'quest-world', 'curatorship', 'independently', 'company-sites', 'special-versions', 'special-versions-details', 'tgk-communities', 'companies', 'team-search',
            'interactive', 'google-sheets', 'support', 'bot-issues', 'user-agreement', 'news'
        ];
        
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            const targetScreen = document.getElementById(screenId);
            targetScreen.classList.add('active');
            history.push(screenId);

            // Всегда белый фон
            document.body.classList.add('white-bg');

            const logo = document.querySelector('.logo');
            if (screenId === 'initial-welcome') {
                logo.classList.add('visible');
            } else {
                logo.classList.remove('visible');
            }

            if (screenId === 'google-sheets') {
                loadLapabalts();
            }
            if (screenId === 'news') {
                loadNews();
            }
        }

        function goBack() {
            if (history.length > 1) {
                history.pop();
                const previousScreen = history[history.length - 1];
                document.querySelectorAll('.screen').forEach(screen => {
                    screen.classList.remove('active');
                });
                document.getElementById(previousScreen).classList.add('active');
                // Всегда белый фон
                document.body.classList.add('white-bg');
            }
        }

        // Telegram авторизация
        function onTelegramAuth(user) {
            currentUser = user;
            document.getElementById('telegram-login-container').style.display = 'none';
            
            // Показываем кнопку админ-панели только для админов
            if (adminIds.includes(user.id)) {
                document.getElementById('admin-menu-btn').style.display = '';
            } else {
                document.getElementById('admin-menu-btn').style.display = 'none';
            }

            // Показываем приложение после авторизации
            showScreen('initial-welcome');
        }

        // Функция для показа промтов GPT
        function showGptPrompts() {
            document.getElementById('gpt-modal').style.display = 'flex';
        }

        // Функция для закрытия модального окна
        function closeGptModal() {
            document.getElementById('gpt-modal').style.display = 'none';
        }

        // Закрытие модального окна при клике вне его
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('gpt-modal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeGptModal();
                }
            });
        });

        // Функция для обработки прокрутки
        function handleScroll() {
            const footer = document.querySelector('.footer');
            const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
            const scrollHeight = document.documentElement.scrollHeight;
            const clientHeight = document.documentElement.clientHeight;
            
            if (scrollTop + clientHeight >= scrollHeight - 5) {
                footer.classList.add('visible');
            } else {
                footer.classList.remove('visible');
            }
        }

        // Добавляем обработчик прокрутки
        window.addEventListener('scroll', handleScroll);

        // Инициализация Telegram WebApp
        tg.expand();
        tg.enableClosingConfirmation();

        // Установка версии и даты в футер
        document.getElementById('footer-version').textContent = `Версия ${botVersion} | Последнее обновление: ${lastUpdateDate}`;

        // === Функции для работы с Google Таблицами ===
        async function loadLapabalts() {
            const dataContainer = document.getElementById('lapabalts-data');
            dataContainer.innerHTML = '<p>Загрузка данных...</p>';

            try {
                const response = await fetch(googleSheetsUrl);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const csvText = await response.text();
                
                const rows = csvText.split(/\r?\n/).map(row => row.trim()).filter(row => row.length > 0);
                
                if (rows.length < 2) {
                    dataContainer.innerHTML = '<p>Данные не найдены или таблица пуста.</p>';
                    return;
                }

                dataContainer.innerHTML = '';

                // Добавляем заголовки
                dataContainer.innerHTML += `<div class="lapabalts-header">Имя пользователя Telegram</div><div class="lapabalts-header">Лапабаллы</div>`;

                // Пропускаем первую строку (заголовки) и обрабатываем остальные
                for (let i = 1; i < rows.length; i++) {
                    const cols = rows[i].split(',');
                    if (cols.length >= 2) {
                        const username = cols[0].trim();
                        const lapabalts = cols[1].trim();
                        dataContainer.innerHTML += `<div class="lapabalts-item">${username}</div><div class="lapabalts-item">${lapabalts}</div>`;
                    }
                }

            } catch (error) {
                console.error('Ошибка загрузки данных:', error);
                dataContainer.innerHTML = '<p>Не удалось загрузить данные. Проверьте ссылку и настройки публикации таблицы.</p>';
            }
        }

        // Открыть админ-панель
        function openAdminPanel() {
            document.getElementById('admin-panel').style.display = 'block';
        }
        // Закрыть админ-панель
        function closeAdminPanel() {
            document.getElementById('admin-panel').style.display = 'none';
        }

        // Админские функции
        function updateLapabalts() {
            const username = document.getElementById('admin-username').value;
            const value = document.getElementById('admin-lapabalts').value;
            if (!username || !value) {
                alert('Заполните все поля!');
                return;
            }
            const formData = new URLSearchParams();
            formData.append('action', 'update_lapabalts');
            formData.append('username', username);
            formData.append('lapabalts', value);
            fetch(googleScriptUrl, {
                method: 'POST',
                body: formData
            })
            .then(res => res.json())
            .then(res => {
                if (res.status === 'ok') {
                    alert('Лапабаллы обновлены!');
                    document.getElementById('admin-username').value = '';
                    document.getElementById('admin-lapabalts').value = '';
                } else {
                    alert('Ошибка при обновлении!');
                }
            })
            .catch(error => {
                console.error('Ошибка:', error);
                alert('Ошибка при обновлении!');
            });
        }

        function createNews() {
            const text = document.getElementById('admin-news-text').value;
            if (!text.trim()) {
                alert('Введите текст новости!');
                return;
            }
            const formData = new URLSearchParams();
            formData.append('action', 'create_news');
            formData.append('author', currentUser.first_name || currentUser.username || 'Админ');
            formData.append('text', text);
            fetch(googleScriptUrl, {
                method: 'POST',
                body: formData
            })
            .then(res => res.json())
            .then(res => {
                if (res.status === 'ok') {
                    alert('Новость опубликована!');
                    document.getElementById('admin-news-text').value = '';
                } else {
                    alert('Ошибка при публикации!');
                }
            })
            .catch(error => {
                console.error('Ошибка:', error);
                alert('Ошибка при публикации!');
            });
        }

        // Загрузка новостей
        async function loadNews() {
            const newsContainer = document.getElementById('news-container');
            newsContainer.innerHTML = '<p>Загрузка новостей...</p>';
            try {
                const response = await fetch(`${googleScriptUrl}?action=get_news`);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const news = await response.json();
                if (news.length === 0) {
                    newsContainer.innerHTML = '<p>Новостей пока нет.</p>';
                    return;
                }
                newsContainer.innerHTML = '';
                news.forEach(item => {
                    const date = new Date(item.date).toLocaleDateString('ru-RU');
                    newsContainer.innerHTML += `
                        <div class="news-item">
                            <div class="news-author">👤 ${item.author}</div>
                            <div class="news-date">📅 ${date}</div>
                            <div class="news-text">${item.text}</div>
                        </div>
                    `;
                });
            } catch (error) {
                console.error('Ошибка загрузки новостей:', error);
                newsContainer.innerHTML = '<p>Не удалось загрузить новости.</p>';
            }
        }

        // Показать новости (разрешено только админам)
        function openNews() {
            if (currentUser && adminIds.includes(currentUser.id)) {
                showScreen('news');
            } else {
                showModalSoon();
            }
        }

        // Модальное окно "В разработке" для новостей
        function showModalSoon() {
            document.getElementById('news-modal').style.display = 'flex';
        }
        function closeNewsModal() {
            document.getElementById('news-modal').style.display = 'none';
        }
        // Закрытие модального окна при клике вне его
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('news-modal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeNewsModal();
                }
            });
        });

        // === ЛапаКликер ===
        let lapaclickerUser = '';
        let lapaclickerMax = 0;
        let lapaclickerCount = 0;

        function showLapaclicker() {
            showScreen('lapaclicker');
            if (currentUser && currentUser.username) {
                lapaclickerUser = currentUser.username;
                document.getElementById('lapaclicker-auth').style.display = 'none';
                document.getElementById('lapaclicker-game').style.display = '';
                document.getElementById('lapaclicker-user').textContent = lapaclickerUser;
                lapaclickerLoad();
            } else {
                document.getElementById('lapaclicker-auth').style.display = '';
                document.getElementById('lapaclicker-game').style.display = 'none';
            }
        }

        function lapaclickerStart() {
            const username = document.getElementById('lapaclicker-username').value.trim();
            if (!username) {
                alert('Введите ник!');
                return;
            }
            lapaclickerUser = username;
            document.getElementById('lapaclicker-auth').style.display = 'none';
            document.getElementById('lapaclicker-game').style.display = '';
            document.getElementById('lapaclicker-user').textContent = lapaclickerUser;
            lapaclickerLoad();
        }

        async function lapaclickerLoad() {
            document.getElementById('lapaclicker-max').innerHTML = '<span class="lapaclicker-spinner"></span>';
            try {
                lapaclickerMax = await getUserClicks(lapaclickerUser);
            } catch {
                lapaclickerMax = 0;
            }
            lapaclickerCount = 0;
            document.getElementById('lapaclicker-max').textContent = lapaclickerMax;
            document.getElementById('lapaclicker-count').textContent = lapaclickerCount;
        }

        function lapaclickerClick() {
            lapaclickerCount++;
            document.getElementById('lapaclicker-count').textContent = lapaclickerCount;
        }

        // saveResult — новая логика сохранения результата
        async function saveResult() {
            if (!lapaclickerUser) return;
            if (lapaclickerCount > lapaclickerMax) {
                try {
                    await saveUserClicks(lapaclickerUser, lapaclickerCount);
                    lapaclickerMax = lapaclickerCount;
                    lapaclickerCount = 0;
                    document.getElementById('lapaclicker-max').textContent = lapaclickerMax;
                    document.getElementById('lapaclicker-count').textContent = lapaclickerCount;
                } catch (e) {
                    if (window.Telegram && Telegram.WebApp && Telegram.WebApp.showAlert) {
                        Telegram.WebApp.showAlert('Ошибка сохранения! Попробуйте ещё раз.');
                    } else {
                        alert('Ошибка сохранения! Попробуйте ещё раз.');
                    }
                    // НЕ сбрасываем счётчик!
                }
            } else {
                // Если результат не больше максимума — просто обновляем UI
                lapaclickerCount = 0;
                document.getElementById('lapaclicker-count').textContent = lapaclickerCount;
            }
        }

        // Переопределяем кнопку для показа кликера
        const lapaclickerBtn = document.querySelector('button[onclick="showScreen(\'lapaclicker\')"]');
        if (lapaclickerBtn) lapaclickerBtn.setAttribute('onclick', 'showLapaclicker()');

        function showModalSoon(feature) {
            let icon = '🚧';
            let title = 'В разработке!';
            let text = 'Этот раздел скоро появится для всех пользователей.<br>Следите за обновлениями!';
            if (feature === 'lapaclicker') {
                icon = '🐾';
                title = 'ЛапаКликер';
                text = 'ЛапаКликер — мини-игра для всех участников!<br>Скоро будет доступна прямо в приложении.';
            }
            const modal = document.createElement('div');
            modal.className = 'modal-overlay';
            modal.style.display = 'flex';
            modal.innerHTML = `
                <div class="modal-content">
                    <div class="modal-icon">${icon}</div>
                    <div class="modal-title">${title}</div>
                    <div class="modal-text">${text}</div>
                    <button class="modal-button" onclick="this.closest('.modal-overlay').remove()">Понятно</button>
                </div>
            `;
            document.body.appendChild(modal);
            modal.addEventListener('click', function(e) {
                if (e.target === modal) modal.remove();
            });
        }

        // Энциклопедия: определения
        const encyclopediaDefs = [
            '',
            'Мир квестов (МК, мирок) — главный квестовый агрегатор, почти все квесты Москвы вы можете найти именно на нем',
            'Клаустрофобия (клаусы) — чуть менее популярный квестовый агрегатор, чем Мир квестов, но на нем также стоят многие квесты',
            'Мк команды (мкшники) — игроки, которые ходят через агрегаторов',
            'Лимонницы/лимонники — как правило несовершеннолетние игроки, которые ходят за эро контактом',
            'Quest Stars (кусты) — квестовая компания, которая под своим куполом собирает почти все перформансы Москвы',
            'Quest Vision (квест вижин) — компания, которая делает видео-прохождения квестов, её главой является Артём квествижин',
            'Голубь — администратор телеграмм канала «Мир глазами голубя», очень известный обзорщик',
            'Зелень (зеленка) — игроки, которые являются новичками в квест индустрии',
            'ФОП спецухи — спец версии, которые делают актеры с фопа, часто такие спецухи пишутся на коленке и ставятся на скорую руку',
            'Электрозавод (завод) — сгоревший завод на Электрозаводской на котором раньше стояли многие квесты Москвы',
            'ИГС, АХС и тд — аббревиатуры квестов, составленные по первым буквам слов из названия',
            'Куратор — актер или опытный игрок, который может тебя забронировать со скидкой на квест и договорится по возрастному ограничению',
            'Купонные квесты (фс) — квесты очень низкого качества «подвальные», на них обычно ходят по купонам, цена за команду из 4 человек обычно составляет 2,5 тысячи рублей. Ранее была компания, которая делала проекты низкого качества, называлась она «Фактор страха», компания распалась. А «прозвище» низкокачественных проектов осталось',
            'Биглион — сайт на котором можно купить купоны на фс квесты',
            'Индивидуальное задание (индива, индивидуалка) — задание на квесте, на которое может отправиться только один игрок из команды',
            'Обзорщики — игроки, которые как правило пишут рецензии на квесты',
            'Спецверсия (спецуха) — специальная версия квеста, которая ставится на локации какого-то квеста, но с новым сюжетом',
            'Альтернативная версия (альтернативка) — специальная версия квеста, которая как правило является приквелом или сиквелом основного сюжета квеста, либо же просто другой версией с видоизмененным сюжетом и жанром',
            'Фейс ту Фейс — скримеры, которые делаются при маленьком расстоянием с актером из темноты «лицом к лицу»',
            'Подслушка (пки) — послушано квестовой индустрии, в котором игроки могут найти себе команду на квест или разместить отзыв на квест',
            'Контакт — это уровень взаимодействия с актером, обычно он делится на:\n1. Лайт - легкие касания\n2. Медиум - актер может тебя схватить за плечо, руку, утащить куда-то\n3. Хард - плотный контакт с актером',
            'Морковка - так сейчас называют контакт',
            'Экшен часть (экшен) — это часть квеста, которая заключается в погоне персонажа за тобой, обычно сопровождается выдачей контакта',
            'Госты — это государственный стандарт квестов, в котом прописаны многие элементы квестов, которые запрещены. Но большинство квестов на них забивают',
        ];

        function showEncycloDef(idx) {
            const list = document.getElementById('encyclopedia-list');
            const def = document.getElementById('encyclopedia-def');
            list.style.display = 'none';
            def.style.display = '';
            def.innerHTML = `<div class=\"text-content\">${encyclopediaDefs[idx]}</div>`;
        }
        function encycloBack() {
            document.getElementById('encyclopedia-list').style.display = '';
            document.getElementById('encyclopedia-def').style.display = 'none';
        }

        // Исправленный обработчик для единственной кнопки "Назад" в энциклопедии
        const encyclopediaBackBtn = document.getElementById('encyclopedia-back');
        if (encyclopediaBackBtn) {
            encyclopediaBackBtn.onclick = function() {
                const def = document.getElementById('encyclopedia-def');
                if (def.style.display === '' && def.innerHTML.trim() !== '') {
                    encycloBack();
                } else {
                    goBack();
                }
            };
        }
    </script>

<script>
const supabaseUrl = 'https://sqpfscuyofevrywfbubm.supabase.co';
const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNxcGZzY3V5b2ZldnJ5d2ZidWJtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE0NTA0NTIsImV4cCI6MjA2NzAyNjQ1Mn0.QQFwpBpMSe1eslWPpMGV86qCsYluHUvMYEBEn-lqFdo';

async function saveUserClicks(username, clicks) {
  console.log("➡️ Сохраняем:", { username, clicks });
  const res = await fetch(`${supabaseUrl}/rest/v1/clicks`, {
    method: 'POST',
    headers: {
      'apikey': supabaseKey,
      'Authorization': `Bearer ${supabaseKey}`,
      'Content-Type': 'application/json',
      'Prefer': 'resolution=merge-duplicates'
    },
    body: JSON.stringify([{ username, clicks }])
  });
  const data = await res.json();
  console.log("✅ Ответ от Supabase:", res.status, data);
  return { success: res.ok, data };
}

async function getUserClicks(username) {
  const res = await fetch(`${supabaseUrl}/rest/v1/clicks?username=eq.${encodeURIComponent(username)}&select=clicks`, {
    headers: {
      'apikey': supabaseKey,
      'Authorization': `Bearer ${supabaseKey}`
    }
  });
  const data = await res.json();
  return data[0]?.clicks || 0;
}

async function saveResult() {
  if (!tg.initDataUnsafe?.user?.username) {
    tg.showAlert('Ошибка: пользователь не найден');
    return;
  }
  const username = tg.initDataUnsafe.user.username;
  const clicks = currentClicks;

  try {
    const result = await saveUserClicks(username, clicks);
    if (result.success) {
      tg.showAlert('Результат сохранён!');
      currentClicks = 0;
      updateClickCount();
    } else {
      tg.showAlert('Ошибка сохранения. Подробности в консоли.');
      console.error('❌ Ошибка при сохранении:', result.data);
    }
  } catch (error) {
    tg.showAlert('Ошибка сети. Повторите попытку.');
    console.error('🌐 Сетевая ошибка:', error);
  }
}
</script>

</body>
</html>
